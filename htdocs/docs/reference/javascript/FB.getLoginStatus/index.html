<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/</title>
<link rel="stylesheet" href="/css/common.css" media="screen" />
<script src="/js/common.js"></script>
</head>
<body>
<a id="oklahomer-orig-url" href="https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/">https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/</a>

<div id="oklahomer-menu-wrapper">
<div class="toplevelnav">
<ul>
<li>
<a href="/docs/" name="https://developers.facebook.com/docs/">
<div class="navSectionTitle">Getting Started</div>
</a>
</li>
<li>
<a href="/docs/coreconcepts/" name="https://developers.facebook.com/docs/coreconcepts">
<div class="navSectionTitle">Core Concepts</div>
</a>
</li>
<li>
<a href="/docs/advancedtopics/" name="https://developers.facebook.com/docs/advancedtopics">
<div class="navSectionTitle">Advanced Topics</div>
</a>
</li>
<li class="active withsubsections">
<a class="selected" href="/docs/sdks/" name="https://developers.facebook.com/docs/sdks">
<div class="navSectionTitle">SDK Reference</div>
</a>
<ul class="subsections">
<li>
<a class="selected" href="/docs/reference/javascript/" name="https://developers.facebook.com/docs/reference/javascript/">JavaScript SDK</a>
</li>
<li>
<a href="/docs/reference/php/" name="https://developers.facebook.com/docs/reference/php">PHP SDK</a>
</li>
<li>
<a href="/docs/reference/iossdk/" name="https://developers.facebook.com/docs/reference/iossdk">iOS SDK</a>
</li>
<li>
<a href="/docs/reference/androidsdk/" name="https://developers.facebook.com/docs/reference/androidsdk">Android SDK</a>
</li>
</ul>
</li>
<li>
<a href="https://developers.facebook.com/tools" name="https://developers.facebook.com/tools" target="_blank">
<div class="navSectionTitle">Tools</div>
</a>
</li>
</ul>
</div>
<ul id="navsubsectionpages">
<li>
</li>
<li>
<h5>Core Methods</h5>
<ul>
<li>
<a href="/docs/reference/javascript/FB.api/" name="http://developers.facebook.com/docs/reference/javascript/FB.api/">FB.api</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.init/" name="http://developers.facebook.com/docs/reference/javascript/FB.init/">FB.init</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.ui/" name="http://developers.facebook.com/docs/reference/javascript/FB.ui/">FB.ui</a>
</li>
</ul>
</li>
<li>
<h5>Auth Methods</h5>
<ul>
<li>
<a href="/docs/reference/javascript/FB.getAuthResponse/" name="http://developers.facebook.com/docs/reference/javascript/FB.getAuthResponse/">FB.getAuthResponse</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.getLoginStatus/" name="http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/">FB.getLoginStatus</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.getSession/" name="http://developers.facebook.com/docs/reference/javascript/FB.getSession/">FB.getSession</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.login/" name="http://developers.facebook.com/docs/reference/javascript/FB.login/">FB.login</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.logout/" name="http://developers.facebook.com/docs/reference/javascript/FB.logout/">FB.logout</a>
</li>
</ul>
</li>
<li>
<h5>Event Handling</h5>
<ul>
<li>
<a href="/docs/reference/javascript/FB.Event.subscribe/" name="http://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe/">FB.Event.subscribe</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Event.unsubscribe/" name="http://developers.facebook.com/docs/reference/javascript/FB.Event.unsubscribe/">FB.Event.unsubscribe</a>
</li>
</ul>
</li>
<li>
<h5>XFBML</h5>
<ul>
<li>
<a href="/docs/reference/javascript/FB.XFBML.parse/" name="http://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/">FB.XFBML.parse</a>
</li>
<li>
<a href="/docs/reference/javascript/xfbml-fb-name/" name="http://developers.facebook.com/docs/reference/javascript/xfbml-fb-name/">fb:name</a>
</li>
</ul>
</li>
<li>
<h5>Canvas Methods</h5>
<ul>
<li>
<a href="/docs/reference/javascript/FB.Canvas.Prefetcher.addStaticResource/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.Prefetcher.addStaticResource/">FB.Canvas.Prefetcher.addStaticResource</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.Prefetcher.setCollectionMode/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.Prefetcher.setCollectionMode/">FB.Canvas.Prefetcher.setCollectionMode</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.getPageInfo/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.getPageInfo/">FB.Canvas.getPageInfo</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.hideFlashElement/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.hideFlashElement/">FB.Canvas.hideFlashElement</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.scrollTo/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.scrollTo/">FB.Canvas.scrollTo</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.setAutoGrow/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/">FB.Canvas.setAutoGrow</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.setDoneLoading/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.setDoneLoading/">FB.Canvas.setDoneLoading</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.setSize/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.setSize/">FB.Canvas.setSize</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.setUrlHandler/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.setUrlHandler/">FB.Canvas.setUrlHandler</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.showFlashElement/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.showFlashElement/">FB.Canvas.showFlashElement</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.startTimer/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.startTimer/">FB.Canvas.startTimer</a>
</li>
<li>
<a href="/docs/reference/javascript/FB.Canvas.stopTimer/" name="http://developers.facebook.com/docs/reference/javascript/FB.Canvas.stopTimer/">FB.Canvas.stopTimer</a>
</li>
</ul>
</li>
</ul></div>

<div id="oklahomer-content-wrapper">
<div class="header">
<div class="content">
<h1>FB.getLoginStatus</h1>
<div class="breadcrumbs">
<a href="/docs/sdks/" name="https://developers.facebook.com/docs/sdks/">SDK Reference</a> › <a href="/docs/reference/javascript/" name="https://developers.facebook.com/docs/reference/javascript/">JavaScript SDK</a> › <a href="/docs/reference/javascript/FB.getLoginStatus/" name="https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/">FB.getLoginStatus</a>
</div>
</div>
</div>
<h3>Overview</h3>
<p>
<code>FB.getLoginStatus</code> allows you to determine if a user is logged in to Facebook and has authenticated your app. There are three possible states for a user:</p>
<ol>
<li>the user is logged into Facebook and has authenticated your application (<code>connected</code>)</li>
<li>the user is logged into Facebook but has not authenticated your application (<code>not_authorized</code>)</li>
<li>the user is not logged into Facebook at this time and so we don&apos;t know if they&apos;ve authenticated your application or not (<code>unknown</code>)</li>
</ol>
<p>With social application, knowing which of the these three states the user is in is one of the first things your application needs to know upon page load.</p>
<h3>Example</h3>
<p>To determine if a user has authenticated your app:</p>
<pre>
<code>FB.getLoginStatus(function(response) {
  if (response.status === &apos;connected&apos;) {
    // the user is logged in and has authenticated your
    // app, and response.authResponse supplies
    // the user&apos;s ID, a valid access token, a signed
    // request, and the time the access token 
    // and signed request each expire
    var uid = response.authResponse.userID;
    var accessToken = response.authResponse.accessToken;
  } else if (response.status === &apos;not_authorized&apos;) {
    // the user is logged in to Facebook, 
    // but has not authenticated your app
  } else {
    // the user isn&apos;t logged in to Facebook.
  }
 });
</code>
</pre>
<h3 id="response_and_session_objects">Response objects</h3>
<p>If the user has authenticated your application, the response object will look like this:</p>
<pre>
<code>{
    status: &apos;connected&apos;,
    authResponse: {
        accessToken: &apos;...&apos;,
        expiresIn:&apos;...&apos;,
        signedRequest:&apos;...&apos;,
        userID:&apos;...&apos;
    }
}
</code>
</pre>
<p>By testing for the presence of the authResponse object within the response object, you can be sure the user has authenticated your app and you can begin to make further calls to the Facebook APIs. If the authResponse object is not present, the user is either not logged into Facebook, or has not authorized your app.</p>
<p>The most useful parts of the <code>authResponse</code> object are the <code>userID</code> (the user&apos;s ID) and the <code>accessToken</code>. The access token can be used to make requests to the Facebook APIs on behalf of that user. The <code>userID</code> is the unique identifier for the user who&apos;s present in your app.</p>
<h3>Roundtrips to Facebook&apos;s servers</h3>
<p>To improve the performace of your application, not every call to check the status of the user will result in request to Facebook&apos;s servers. Where possible, the response is cached. The first time in the current browser session that <code>FB.getLoginStatus</code> is called, or the JD SDK is init&apos;d with <code>status: true</code>, the response object will be cached by the SDK. Subsequent calls to <code>FB.getLoginStatus</code> will return data from this cached response.</p>
<p>This can cause problems where the user has logged into (or out of) Facebook since the last full session lookup, or if the user has removed your application in their account settings.</p>
<p>To get around this, you call <code>FB.getLoginStatus</code> with the second parameter set to <code>true</code> to force a roundtrip to Facebook - effectively refreshing the cache of the response object.</p>
<pre>
<code>FB.getLoginStatus(function(response) {
  // this will be called when the roundtrip to Facebook has completed
}, true);
</code>
</pre>
<p>If you call <code>FB.getLoginStatus</code> on every page load, be careful not to set this parameter for each as it will significantly increase the number of requests to Facebook&apos;s servers, and thus decrease the performace of your application.</p>
<h3>Checking user status on page load</h3>
<p>While you can call <code>FB.getLoginStatus</code> any time (for example, when the user tries to take a social action), most social apps need to know the user&apos;s status as soon as possible after the page loads. In this case, rather than calling <code>FB.getLoginStatus</code> explicitly, it is possible to check the user&apos;s status by setting <code>status: true</code> when you call <code>FB.init</code>.</p>
<p>To receive the response of this call, you must <a href="/docs/reference/javascript/FB.Event.subscribe/" name="https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe">subscribe</a> to the <code>auth.statusChange</code> event. The response object passed by this event is identical to that which would be returned by calling <code>FB.getLoginStatus</code> explicitly.</p>
<h3>Events</h3>
<p>Subscribing to the authentication events fired by the JS SDK means your app will be notified if the user&apos;s session state changes. This is important because the session state may change due to user interactions beyond your app&apos;s control. The only way your app can be notified of these changes is through subscribing to these event.</p>
<p>Examples of interactions which can change the state of the user include <a href="/docs/reference/javascript/FB.login/" name="https://developers.facebook.com/docs/reference/javascript/FB.login">FB.login()</a>, <a href="/docs/reference/javascript/FB.logout/" name="https://developers.facebook.com/docs/reference/javascript/FB.logout">FB.logout()</a> and the <a href="/docs/reference/plugins/login/" name="https://developers.facebook.com/docs/reference/plugins/login">Login button</a>. Widgets such as the <a href="/docs/reference/plugins/comments/" name="https://developers.facebook.com/docs/reference/plugins/comments/">Comments plugin</a> may also trigger authentication.</p>
<h4>auth.login</h4>
<p>This event is fired when your app first notices the user (in other words, gets a session when it didn&apos;t already have a valid one).</p>
<h4>auth.logout</h4>
<p>This event is fired when your app notices that there is no longer a valid user (in other words, it had a session but can no longer validate the current user).</p>
<h4>auth.authResponseChange</h4>
<p>This event is fired for <strong>any</strong> auth related change as they all affect the session: login, logout, session refresh. Sessions are refreshed over time as long as the user is active with your app.</p>
<h4>auth.statusChange</h4>
<p>Typically you will want to use the auth.authResponseChange event. But in rare cases, you want to distinguish between these three states:</p>
<ul>
<li>Connected</li>
<li>Logged into Facebook but not connected with your application</li>
<li>Not logged into Facebook at all.</li>
</ul>
<p>The <a href="/docs/reference/javascript/FB.Event.subscribe/" name="https://developers.facebook.com/docs/reference/javascript/FB.Event.subscribe">FB.Event.subscribe</a> and <a href="/docs/reference/javascript/FB.Event.unsubscribe/" name="https://developers.facebook.com/docs/reference/javascript/FB.Event.unsubscribe">FB.Event.unsubscribe</a> functions are used to subscribe to these events. For example:</p>
<pre>
<code>FB.Event.subscribe(&apos;auth.login&apos;, function(response) {
  // do something with response
});
</code>
</pre>
<p>The response object returned to all these events is the same as the response from <a href="/docs/reference/javascript/FB.getLoginStatus/" name="https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus">FB.getLoginStatus</a>, <a href="/docs/reference/javascript/FB.login/" name="https://developers.facebook.com/docs/reference/javascript/FB.login">FB.login</a> or <a href="/docs/reference/javascript/FB.logout/" name="https://developers.facebook.com/docs/reference/javascript/FB.logout">FB.logout</a>. This response object contains:</p>
<dl>
<dt>status</dt>
<dd>The status of the User. One of <code>connected</code>, <code>not_authorized</code> or <code>unknown</code>.</dd>
<dt>authResponse</dt>
<dd>The authResponse object.</dd>
</dl>
<h3>Configuration</h3>
<p>In order to use the authentication methods, your app must be configured with an App Domain. App settings can be changed on the <a href="https://developers.facebook.com/apps" name="https://developers.facebook.com/apps" target="_blank">settings page</a>.</p>
<h2>パラメータ</h2>
<table class="params">
<tr>
<th>名前</th>
<th>タイプ</th>
<th>説明</th>
</tr>
<tr>
<td class="name">cb</td>
<td class="type">Function</td>
<td>
<p>The callback function.</p>
</td>
</tr>
<tr>
<td class="name">force</td>
<td class="type">Boolean</td>
<td>
<p>Force reloading the login status (default <code>false</code>).</p>
</td>
</tr>
</table>
<div class="mtl pvm uiBoxWhite topborder">
<div class="mbm lfloat">
<fb:like href="http://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus/" send="true" show_faces="false">
</fb:like>
</div>
<div class="clear">
<abbr class="timestamp" data-utime="1339714218" title="2012年6月14日 15:50">2012年6月14日 15:50</abbr>
</div>
</div></div>

</body>
</html>
