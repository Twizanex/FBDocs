<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>https://developers.facebook.com/docs/requests/</title>
<link rel="stylesheet" href="/css/common.css" media="screen" />
<script src="/js/common.js"></script>
</head>
<body>
<a id="oklahomer-orig-url" href="https://developers.facebook.com/docs/requests/">https://developers.facebook.com/docs/requests/</a>

<div id="oklahomer-menu-wrapper">
<div class="toplevelnav">
<ul>
<li class="active withsubsections">
<a class="selected" href="/docs/" name="https://developers.facebook.com/docs/" target="">
<div class="navSectionTitle">Getting Started</div>
</a>
<ul class="subsections">
<li>
<a href="/docs/guides/web/" name="https://developers.facebook.com/docs/guides/web" target="">Websites</a>
</li>
<li>
<a href="/docs/guides/canvas/" name="https://developers.facebook.com/docs/guides/canvas" target="">Apps on Facebook</a>
</li>
<li>
<a href="/docs/guides/mobile/" name="https://developers.facebook.com/docs/guides/mobile" target="">Mobile</a>
</li>
<li>
<a href="/docs/appcenter/" name="https://developers.facebook.com/docs/appcenter/" target="">App Center</a>
</li>
<li>
<a href="/docs/bestpractices/" name="https://developers.facebook.com/docs/bestpractices/" target="">Best Practices</a>
</li>
<li>
<a href="/docs/samples/" name="https://developers.facebook.com/docs/samples" target="">Samples &amp; How-Tos</a>
</li>
<li>
<a href="https://developers.facebook.com/videos" name="https://developers.facebook.com/videos" target="_blank">Videos</a>
</li>
</ul>
</li>
<li>
<a href="/docs/coreconcepts/" name="https://developers.facebook.com/docs/coreconcepts" target="">
<div class="navSectionTitle">Core Concepts</div>
</a>
</li>
<li>
<a href="/docs/advancedtopics/" name="https://developers.facebook.com/docs/advancedtopics" target="">
<div class="navSectionTitle">Advanced Topics</div>
</a>
</li>
<li>
<a href="/docs/sdks/" name="https://developers.facebook.com/docs/sdks" target="">
<div class="navSectionTitle">SDK Reference</div>
</a>
</li>
<li>
<a href="https://developers.facebook.com/tools" name="https://developers.facebook.com/tools" target="_blank">
<div class="navSectionTitle">Tools</div>
</a>
</li>
</ul>
</div>
<ul id="navsubsectionpages">
<li>
</li>
<li class="active">
<h5>Getting Started</h5>
<ul>
<li>
<a href="/docs/appsonfacebook/tutorial/" name="http://developers.facebook.com/docs/appsonfacebook/tutorial/" target="">Canvas Tutorial</a>
</li>
<li>
<a href="/docs/guides/games/getting-started/" name="http://developers.facebook.com/docs/guides/games/getting-started/" target="">Social Games Tutorial</a>
</li>
<li>
<a href="/docs/guides/games/growth/" name="http://developers.facebook.com/docs/guides/games/growth/" target="">Social Channels for Games</a>
</li>
<li>
<a class="selected" href="/docs/requests/" name="http://developers.facebook.com/docs/requests/" target="">Requests Overview</a>
</li>
<li>
<a href="/docs/appsonfacebook/pagetabs/" name="http://developers.facebook.com/docs/appsonfacebook/pagetabs/" target="">Page Tab Tutorial</a>
</li>
</ul>
</li>
<li>
<h5>Best Practices</h5>
<ul>
<li>
<a href="/docs/guides/games/auth/" name="http://developers.facebook.com/docs/guides/games/auth/" target="">Authentication Pro-tips</a>
</li>
<li>
<a href="/docs/guides/games/requests/" name="http://developers.facebook.com/docs/guides/games/requests/" target="">Requests Pro-tips</a>
</li>
<li>
<a href="/docs/guides/games/feed/" name="http://developers.facebook.com/docs/guides/games/feed/" target="">Feed Pro-tips</a>
</li>
<li>
<a href="/docs/guides/games/canvas/" name="http://developers.facebook.com/docs/guides/games/canvas/" target="">Integrating with Canvas</a>
</li>
<li>
<a href="/docs/guides/games/monetization/" name="http://developers.facebook.com/docs/guides/games/monetization/" target="">Games Monetization</a>
</li>
</ul>
</li>
<li>
<h5>Showcase</h5>
<ul>
<li>
<a href="/docs/arcadegames/" name="http://developers.facebook.com/docs/arcadegames/" target="">Arcade Games</a>
</li>
<li>
<a href="/docs/bingobash/" name="http://developers.facebook.com/docs/bingobash/" target="">Bingo Bash</a>
</li>
<li>
<a href="/docs/diamonddash/" name="http://developers.facebook.com/docs/diamonddash/" target="">Diamond Dash</a>
</li>
<li>
<a href="http://developers.facebook.com/showcase/games/" name="http://developers.facebook.com/showcase/games/" target="_blank">Games Gallery</a>
</li>
</ul>
</li>
<li>
<h5>How Tos</h5>
<ul>
<li>
<a href="/docs/fluidcanvas/" name="http://developers.facebook.com/docs/fluidcanvas/" target="">Fluid Canvas</a>
</li>
<li>
<a href="/docs/feed-gaming/" name="http://developers.facebook.com/docs/feed-gaming/" target="">Feed Gaming</a>
</li>
<li>
<a href="/docs/hideflashcallback/" name="http://developers.facebook.com/docs/hideflashcallback/" target="">Flash wmode</a>
</li>
<li>
<a href="/docs/guides/games/custom-muti-friend-selector/" name="http://developers.facebook.com/docs/guides/games/custom-muti-friend-selector/" target="">Multi-Friend Selector</a>
</li>
</ul>
</li>
<li>
<h5>Reference</h5>
<ul>
<li>
<a href="/docs/achievements/" name="http://developers.facebook.com/docs/achievements/" target="">Achievements</a>
</li>
<li>
<a href="/docs/score/" name="http://developers.facebook.com/docs/score/" target="">Scores</a>
</li>
<li>
<a href="/docs/reqests_dialog/" name="http://developers.facebook.com/docs/reqests_dialog/" target="">Requests Dialog</a>
</li>
<li>
<a href="/docs/fb_source/" name="http://developers.facebook.com/docs/fb_source/" target="">fb_source Parameter</a>
</li>
</ul>
</li>
</ul></div>

<div id="oklahomer-content-wrapper">
<div class="header">
<div class="content">
<h1>Requests Overview</h1>
<div class="breadcrumbs">
<a href="/docs/" name="https://developers.facebook.com/docs/">Getting Started</a> › <a href="/docs/guides/canvas/" name="https://developers.facebook.com/docs/guides/canvas/">Apps on Facebook</a> › <a href="/docs/requests/" name="https://developers.facebook.com/docs/requests/">Requests Overview</a>
</div>
</div>
</div>
<p>Requests are a one to one communication between a sender [user or app] and recipient [user]. While a single Request can be sent to multiple recipient users at one time, the recipient views the Request from the sender and cannot see other recipients. Requests are always private, a user&apos;s friends cannot see the user&apos;s Requests. Requests do not require any extended permissions to implement.</p>
<p>If you are migrating from the previous <a href="/docs/reference/fbml/request-form/" name="https://developers.facebook.com/docs/reference/fbml/request-form/">FBML Requests</a>, keep in mind that Requests are no longer deleted when a user clicks on them. It is the <strong>Developers&apos; responsibility</strong> to delete a Request once it has been accepted. For more information on how to delete a request see the <a href="/docs/#deleting" name="https://developers.facebook.com/docs/#deleting">Deleting Requests</a> section. It is not possible to delete Requests sent to users that have not installed your app, these Requests will naturally timeout and be cleared automatically.</p>
<p>Requests can be divided into two types: <a href="/docs/#user_to_user" name="https://developers.facebook.com/docs/#user_to_user">User to User Requests</a> and <a href="/docs/#app_to_user" name="https://developers.facebook.com/docs/#app_to_user">App to User</a> Requests.</p>
<p>
<a name="user_to_user">
</a>  </p>
<h2>User To User Requests</h2>
<p>User to User Requests are used to elicit a social action between users, for example &quot;Please join my Team&quot; in a baseball game. User to User Requests are sent via the <a href="/docs/reference/dialogs/" name="https://developers.facebook.com/docs/reference/dialogs/">Dialog API</a>, for more information see the <a href="/docs/reference/dialogs/requests/" name="https://developers.facebook.com/docs/reference/dialogs/requests/">Requests Dialog</a> docs. User to User Requests are only available for <a href="/docs/appsonfacebook/tutorial/" name="https://developers.facebook.com/docs/appsonfacebook/tutorial/">Canvas</a> apps, not websites, as accepting a request will direct the user to the Canvas Page URL of the app that sent the Request.</p>
<p>User to User Requests can be sent in 3 scenarios:</p>
<ol>
<li>The recipient is a <b>friend</b> of the sender and has <b>not installed</b> the app. This is considered an <strong>Invite</strong>.</li>
<li>The recipient is is a <b>friend</b> of the sender and has <b>installed</b> the app.</li>
<li>The recipient has <b>installed</b> the app. In this case the sender and recipient do not need to be friends.</li>
</ol>
<p>Requests that are Invites (the recipient user has not installed the app) do not display the <code>message</code> parameter and are categorized differently in the <a href="https://www.facebook.com/games/" name="https://www.facebook.com/games/">Apps and Games Dashboard</a>. For more information on available parameters see the <a href="/docs/reference/dialogs/requests/" name="https://developers.facebook.com/docs/reference/dialogs/requests/">Request Dialog</a>.</p>
<h3>Notifying Users of a User Request</h3>
<p>The recipient of the Request is notified via an update to the notification jewel:</p>
<p>
<img src="https://developers.facebook.com/attachment/167226_796701122401_703_41122133_4594883_n.jpeg" />
<br />
<img src="https://developers.facebook.com/attachment/180186_796701107431_703_41122131_7224336_n.jpeg" />
<br />
</p>
<p>In addition, if the recipient has the app installed they will see an increased count next to the app bookmark. Clicking on the bookmark will take the user directly to the app or game.</p>
<p>
<img src="https://developers.facebook.com/attachment/app_bookmak.png/" />
</p>
<p>Recipients of the Request will also be notified by an increased count next to the <a href="https://www.facebook.com/games" name="https://www.facebook.com/games">Apps and Games Dashboard</a>.</p>
<p>
<img src="https://developers.facebook.com/attachment/app_games_bookmark.jpg/" />
</p>
<p>Clicking on the <a href="https://www.facebook.com/games" name="https://www.facebook.com/games">Apps and Games Dashboard</a> bookmark will load the Dashboard where a user will see a list of all outstanding Requests and can choose to accept or “X” out the Request. Accepting the Request will direct the user to the app Canvas page.</p>
<p>
<img src="https://developers.facebook.com/attachment/app_games_dashboard.jpg/" />
</p>
<p>Clicking “X” allows the user to ignore the Request and choose if they would like to ignore all Requests from an app.</p>
<p>
<img src="https://developers.facebook.com/attachment/ignore_request.jpg/" />
</p>
<h3>Accepting a User Request</h3>
<p>If a user clicks &apos;Accept&apos; on a Request, they will be sent to the Canvas Page URL of the app that sent the Request. This URL will contain an additional GET parameter <code>request_ids</code>, which is a comma delimited list of Request IDs that a user is trying to act upon:</p>
<pre>
<code>https://apps.facebook.com/[app_name]/?request_ids=[request_ids]
</code>
</pre>
<p>Then as the user handles the request(s) you must delete them via the Graph API, see <a href="/docs/#deleting" name="https://developers.facebook.com/docs/#deleting">Deleting Requests</a>. As a best practice when the the user lands in your app you should <a href="/docs/reference/api/user/#apprequests" name="https://developers.facebook.com/docs/reference/api/user/#apprequests">read</a> outstanding app requests via the <a href="/docs/reference/api/user/#apprequests" name="https://developers.facebook.com/docs/reference/api/user/#apprequests">Graph API</a>.</p>
<p>
<a name="app_to_user">
</a>  </p>
<h2>App To User Requests</h2>
<p>App to User Requests can be used to re-engage a user in your app and can only be sent to users that have installed the app. For example, notifying a user that something has changed since their last visit, &quot;10 of your friends are now online&quot;.</p>
<p>App to User Request are sent via the <a href="/docs/reference/api/" name="https://developers.facebook.com/docs/reference/api/">Graph API</a>, for more information see the <a href="/docs/reference/api/user/#apprequests" name="https://developers.facebook.com/docs/reference/api/user/#apprequests">apprequests</a> docs. App to User Requests are only available for <a href="/docs/appsonfacebook/tutorial/" name="https://developers.facebook.com/docs/appsonfacebook/tutorial/">Canvas</a> apps, not websites, as accepting a request will direct the user to the Canvas Page URL of the app that sent the Request.</p>
<h3>Notifying Users of a App Request</h3>
<p>App to User Requests do not create notifications, though they do appear in the <a href="https://www.facebook.com/games" name="https://www.facebook.com/games">App and Games Dashboard</a> and increment an app bookmark counter, similar to <a href="/docs/#user_to_user" name="https://developers.facebook.com/docs/#user_to_user">User to User Requests</a>.</p>
<h3>Accepting an App Request</h3>
<p>This process is identical to accepting a <a href="/docs/#user_to_user" name="https://developers.facebook.com/docs/#user_to_user">User to User</a> Request.</p>
<p>
<a name="request_format">
</a>  </p>
<h2>Request ID Format</h2>
<p>Each Request that is sent, whether <a href="/docs/#user_to_user" name="https://developers.facebook.com/docs/#user_to_user">User to User</a> or <a href="/docs/#app_to_user" name="https://developers.facebook.com/docs/#app_to_user">App to User</a>, has a unique Request Object ID. This ID represents the Request itself. This Request Object ID can be concatenated with a recipient User ID to create the specific instance of the Request - this represents the Request that was sent to that user.</p>
<p>For example, when sending a Request via either the <a href="/docs/reference/dialogs/requests/" name="https://developers.facebook.com/docs/reference/dialogs/requests">Dialog API</a> or the <a href="/docs/reference/api/user/#apprequests" name="https://developers.facebook.com/docs/reference/api/user/#apprequests">Graph API</a> the response will look like:</p>
<pre>
{
  request: &apos;REQUEST_OBJECT_ID&apos;
  to:[array of USER_IDs]
}
</pre>
<p>If you look up the Request Object ID via the Graph API with</p>
<pre>
<code>https://graph.facebook.com/&lt;REQUEST_OBJECT_ID&gt;?access_token=APP_ACCESS_TOKEN
</code>
</pre>
<p>You will get a response that looks like this for a <a href="/docs/#user_to_user" name="https://developers.facebook.com/docs/#user_to_user">User to User</a> Request:</p>
<pre>
{
  &quot;id&quot;: &quot;REQUEST_OBJECT_ID&quot;, 
  &quot;application&quot;: {
    &quot;name&quot;: &quot;APP_DISPLAY_NAME&quot;, 
    &quot;canvas_name&quot;: &quot;APP_NAME&quot;,  // This is identical to the app namespace
    &quot;namespace&quot;: &quot;APP_NAMESPACE&quot;, 
    &quot;id&quot;: &quot;APP_ID&quot;
  }, 
  &quot;from&quot;: {
    &quot;name&quot;: &quot;SENDER_USER_NAME&quot;, 
    &quot;id&quot;: &quot;SEND_USER_ID&quot;
  }, 
  &quot;message&quot;: &quot;Check out this Awesome Request!&quot;, 
  &quot;created_time&quot;: &quot;2012-01-24T00:43:22+0000&quot;, 
  &quot;type&quot;: &quot;apprequest&quot;
}
</pre>
<p>and a response that looks like this for an <a href="/docs/#app_to_user" name="https://developers.facebook.com/docs/#app_to_user">App to User</a> Request:</p>
<pre>
{
  &quot;id&quot;: &quot;REQUEST_OBJECT_ID&quot;, 
  &quot;application&quot;: {
    &quot;name&quot;: &quot;APP_DISPLAY_NAME&quot;, 
    &quot;canvas_name&quot;: &quot;APP_NAME&quot;,  // This is identical to the app namespace
    &quot;namespace&quot;: &quot;APP_NAMESPACE&quot;, 
    &quot;id&quot;: &quot;APP_ID&quot;
  },
  &quot;message&quot;: &quot;Check out this Awesome Request!&quot;, 
  &quot;created_time&quot;: &quot;2012-01-24T00:43:22+0000&quot;, 
  &quot;type&quot;: &quot;apprequest&quot;
}
</pre>
<p>To get the full Request that includes the recipient user, you will need to append the recipient user ID:</p>
<pre>
<code>https://graph.facebook.com/&lt;REQUEST_OBJECT_ID&gt;_&lt;USER_ID&gt;?access_token=APP_ACCESS_TOKEN
</code>
</pre>
<p>or use the recipient User Access Token:</p>
<pre>
<code>https://graph.facebook.com/&lt;REQUEST_OBJECT_ID&gt;?access_token=USER_ACCESS_TOKEN
</code>
</pre>
<p>which will return a response of:</p>
<pre>
{
  &quot;id&quot;: &quot;REQUEST_OBJECT_ID&quot;, 
  &quot;application&quot;: {
    &quot;name&quot;: &quot;APP_DISPLAY_NAME&quot;, 
    &quot;canvas_name&quot;: &quot;APP_NAME&quot;,  // This is identical to the app namespace
    &quot;namespace&quot;: &quot;APP_NAMESPACE&quot;, 
    &quot;id&quot;: &quot;APP_ID&quot;
  },
  &quot;to&quot;: {
    &quot;name&quot;: &quot;RECIPIENT_USER_NAME&quot;, 
    &quot;id&quot;: &quot;RECIPIENT_USER_ID&quot;
  }, 
  &quot;from&quot;: {
    &quot;name&quot;: &quot;SENDER_USER_NAME&quot;, 
    &quot;id&quot;: &quot;SEND_USER_ID&quot;
  }, 
  &quot;message&quot;: &quot;Check out this Awesome Request!&quot;, 
  &quot;created_time&quot;: &quot;2012-01-24T00:43:22+0000&quot;, 
  &quot;type&quot;: &quot;apprequest&quot;
}
</pre>
<p>
<a name="deleting">
</a>  </p>
<h2>Deleting Requests</h2>
<p>When a user is directed to your app by clicking accepting a Request you <strong>must</strong> delete the request after it has been accepted. Requests are not automatically deleted once they have been clicked, thus it is the <strong>developer’s responsibility</strong> to clear them once they have been accepted.</p>
<p>You can delete a request via the following methods:</p>
<h3>Graph API</h3>
<p>Issue an HTTP DELETE request to the concatenated <code>request_id</code>:</p>
<pre>
<code>DELETE https://graph.facebook.com/[&lt;REQUEST_OBJECT_ID&gt;_&lt;USER_ID&gt;]?
      access_token=[USER or APP ACCESS TOKEN]
</code>
</pre>
<h3>JavaScript SDK</h3>
<pre>
function deleteRequest(requestId) {
  FB.api(requestId, &apos;delete&apos;, function(response) {
    console.log(response);
  });
}
</pre>
<p>Here is a full PHP sample which shows you how to concatenate the request_id and user_id in order to delete the outstanding requests for a user.</p>
<pre>&lt;?php
    require_once(&apos;php-sdk/facebook.php&apos;);
    $config = array(
    &apos;appId&apos; =&gt; &apos;YOUR_APP_ID&apos;,
    &apos;secret&apos; =&gt; &apos;YOUR_APP_SECRET&apos;,
    );
   $facebook = new Facebook($config);

   //Assuming the user has already authenticated the app
   $user_id = $facebook-&gt;getUser();

   //get the request ids from the query parameter
   $request_ids = explode(&apos;,&apos;, $_REQUEST[&apos;request_ids&apos;]);

   //build the full_request_id from request_id and user_id 
   function build_full_request_id($request_id, $user_id) {
      return $request_id . &apos;_&apos; . $user_id; 
   }

   //for each request_id, build the full_request_id and delete request  
   foreach ($request_ids as $request_id)
   {
      echo (&quot;request_id=&quot;.$request_id.&quot;&lt;br&gt;&quot;);
      $full_request_id = build_full_request_id($request_id, $user_id);  
      echo (&quot;full_request_id=&quot;.$full_request_id.&quot;&lt;br&gt;&quot;);
  
      try {
         $delete_success = $facebook-&gt;api(&quot;/$full_request_id&quot;,&apos;DELETE&apos;);
         if ($delete_success) {
            echo &quot;Successfully deleted &quot; . $full_request_id;}
         else {
           echo &quot;Delete failed&quot;.$full_request_id;}
        }          
      catch (FacebookApiException $e) {
      echo &quot;error&quot;;}
    }
?&gt;
</pre>
<h2>Further reading</h2>
<ul>
<li>For information on scenarios and best practices check out <a href="/docs/guides/games/requests/" name="https://developers.facebook.com/docs/guides/games/requests/">Requests best practices</a>. </li>
<li>For more information on how to use Requests, see the <a href="/docs/reference/dialogs/requests/" name="https://developers.facebook.com/docs/reference/dialogs/requests">Request Dialog</a> docs, Graph API <a href="/docs/reference/api/user/#apprequests" name="https://developers.facebook.com/docs/reference/api/user/#apprequests">apprequests</a> connection and the <a href="/docs/guides/games/" name="https://developers.facebook.com/docs/guides/games/">Games Tutorial</a>.</li>
</ul>
<div class="mtl pvm uiBoxWhite topborder">
<div class="mbm lfloat">
<fb:like href="http://developers.facebook.com/docs/requests/" send="true" show_faces="false">
</fb:like>
</div>
<div class="clear">
<abbr class="timestamp" data-utime="1337749713" title="2012年5月22日 22:08">約2週間前に更新</abbr>
</div>
</div></div>

</body>
</html>
